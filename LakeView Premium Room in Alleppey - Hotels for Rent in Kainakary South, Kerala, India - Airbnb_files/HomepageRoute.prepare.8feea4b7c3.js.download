__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getExploreIsLeanTreatmentFlag=function(){return!1}}),"0d1817",[]);
__d((function(g,r,i,a,m,e,d){"use strict";function n(){const t=r(d[0]);return n=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.ClientNormalizeSearchPaths=function({redirectUrl:l}){var s;const u=(0,p.useLocation)();return l=null!==(s=l)&&void 0!==s?s:S(u),(0,t.useEffect)((()=>{if(null!=l){const t=(0,n().parsePath)(l);(0,E.replaceToHistory)(t.pathname,{params:(0,c.default)(t.search)})}}),[l]),null},e.getRedirectUrl=S;var t=r(d[1]),l=r(d[2]),s=r(d[3]),u=r(d[4]),o=r(d[5]),c=babelHelpers.interopRequireDefault(r(d[6])),E=r(d[7]),p=r(d[8]),f=babelHelpers.interopRequireDefault(r(d[9]));function h(n){return n.replace(/^\/s\/[^/]+\/(homes|experiences)/,'/s/:location/$1')}function S(n){var t;const E=(0,l.selectFiltersFromURL)({pathname:n.pathname,queryString:n.search}),p=(E||{}).refinement_paths,S=(0,s.getTabFromRefinementPaths)(p),R={tabId:S,basePath:o.SEARCH_ENDPOINT};let _=n.search;const O=(0,c.default)(_),P=(0,u.makeSearchPath)(E,R);if(![o.EXPLORE_TABS.HOMES,o.EXPLORE_TABS.EXPERIENCES].includes(S))return S===o.EXPLORE_TABS.ADVENTURES||S===o.EXPLORE_TABS.SELECT_HOMES?(_=decodeURIComponent((0,u.makeQueryStrings)(O,R)),`${P}${_}`):'/';if(null!==(t=null==p?void 0:p.some((n=>'string'==typeof n&&n.startsWith('/playlists'))))&&void 0!==t&&t)return'/';const T=null==p?void 0:p[0];if((0,u.isOnlineExperiences)(E,null!=S?S:o.EXPLORE_TABS.HOMES)&&null!=O.refinement_paths&&'/experiences'!==T&&!(0,u.isOnlineExperiencesSearchRefinementPath)(E))return _=decodeURIComponent((0,u.makeQueryStrings)((0,f.default)(O,['refinement_paths']),R)),`${P}${_}`;if((0,u.isOnlineExperiences)(E,null!=S?S:o.EXPLORE_TABS.HOMES)&&(null!=E.location||null!=E.query||null!=E.place_id))return _=decodeURIComponent((0,u.makeQueryStrings)((0,f.default)(O,['location','query','place_id']),R)),`${P}${_}`;return h(n.pathname)!==h(P)?`${P}${_}`:null}}),"0ef88a",["d69748","a27fc3","3d44ce","1b01f9","f4229b","87916a","a7c4ef","4ee5a9","1e300f","3d4f9e"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return t.default.get('exploreTreatments')||[]};var t=babelHelpers.interopRequireDefault(r(d[0]))}),"23c701",["0a58da"]);
__d((function(g,r,i,a,m,e,d){"use strict";function t(n){return null==n?[]:Array.isArray(n)?n.flatMap(t):'string'==typeof n?[n]:[JSON.stringify(n)]}Object.defineProperty(e,"__esModule",{value:!0}),e.convertToRawParams=function(n){const s=[];return Object.keys(n).forEach((o=>{const u=t(n[o]);s.push({filterName:o,filterValues:u})})),s}}),"294886",[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getRequestVariables=function({categoryBarCacheId:q,exploreTreatments:F,location:P,formFactor:b,isAirlite:A=!1}){const _=(0,l.default)(P.search),{mock:E,campaign:M}=_,T=R((0,u.default)(F)),h=(0,n.default)(T),C=(0,s.feedMapDecouplingHomepageWebPreSSR)(h);if(E)return{mockIdentifier:`ExplorePresentation/${E}`,feedMapDecoupleEnabled:C,isPaginatedRequest:!1,isLeanTreatment:(0,f.getExploreIsLeanTreatmentFlag)()};const O={surface:'HOMEPAGE',homepageParams:M?{campaign:M}:void 0},x={...(0,t.selectFiltersForRequest)({location:P,cdnCacheSafe:!1,cdnExperiments:void 0,treatmentFlags:(0,p.manageTreatmentFlagsWithUpfrontPricingFlag)(h),isPWA:b===c.FORM_FACTOR.COMPACT,isAirlite:A}),...q&&{categoryBarCacheId:q}},H=(0,o.default)({location:P,exploreRequest:x,requestedPageType:'HOMEPAGE',isAirlite:A}),y=(0,t.selectFiltersForRequest)({location:P,cdnCacheSafe:!1,cdnExperiments:void 0,treatmentFlags:(0,p.manageTreatmentFlagsWithUpfrontPricingFlag)(h),isPWA:b===c.FORM_FACTOR.COMPACT,isAirlite:A,isMapRequest:!0}),D=(0,o.default)({location:P,exploreRequest:y,requestedPageType:'HOMEPAGE',isAirlite:A});return{staysSearchRequest:H,...C&&{staysMapSearchRequestV2:D},feedMapDecoupleEnabled:C,announcementRequest:O,isPaginatedRequest:!1,isLeanTreatment:(0,f.getExploreIsLeanTreatmentFlag)()}};var t=r(d[0]),n=babelHelpers.interopRequireDefault(r(d[1])),s=r(d[2]),l=babelHelpers.interopRequireDefault(r(d[3])),o=babelHelpers.interopRequireDefault(r(d[4])),u=babelHelpers.interopRequireDefault(r(d[5])),c=r(d[6]),p=r(d[7]),f=r(d[8]);function R(t){const n=new Set(['feed_map_decoupling_m11_desktop','feed_map_decoupling_m11_moweb']);return null==t?void 0:t.filter((({experiment:t})=>!n.has(t)))}}),"360d23",["3d44ce","6e1627","88c0d4","a7c4ef","e16093","d9a26e","b679e8","74d137","0d1817"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t={document:void 0,getDocument:()=>r(d[1])(d[0]).then(babelHelpers.interopRequireWildcard).then((t=>t.default)),name:'Homepage',type:'query',operationId:'4e25ecbc780cd79124e5effb0abad30f279114a937a43471c641da1f8fa3a13d',normalizedItemsLocators:[{keyPath:["id"],itemsLocation:[{typeCondition:["Query"],responseKey:"presentation"},{typeCondition:["RootPresentationContainer"],responseKey:"staysSearch"},{typeCondition:["StaysSearchPresentation"],responseKey:"results"},{typeCondition:["StaysSearchResponse"],responseKey:"searchResults"},{typeCondition:["StaySearchResult"],responseKey:"listing"}]},{keyPath:["id"],itemsLocation:[{typeCondition:["Query"],responseKey:"presentation"},{typeCondition:["RootPresentationContainer"],responseKey:"staysSearch"},{typeCondition:["StaysSearchPresentation"],responseKey:"mapResults"},{typeCondition:["StaysMapSearchResponse"],responseKey:"mapSearchResults"},{typeCondition:["StaySearchResult"],responseKey:"listing"}]}]};e.default=t}),"3e1d2e",["9e4bac","c592d7"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=o,e.replaceToHistory=function(t,s={}){o((0,n.getHistory)(),t,s)};var t=babelHelpers.interopRequireDefault(r(d[0])),n=r(d[1]);function o(n,o,{maintainScrollPosition:s=!1,maintainQueryParams:l=!1,maintainHash:u=!1,params:c,state:f}={}){const p=(0,t.default)(o,{maintainQueryParams:l,maintainHash:u,params:c});n.replace(p,f),g.window&&!s&&g.window.scrollTo(0,0)}}),"4ee5a9",["be6a20","7934b6"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(l=[]){const n=l.map((({treatmentFlag:t})=>t)).filter(t.default).flat(1);return[...new Set(n)]};var t=babelHelpers.interopRequireDefault(r(d[0]))}),"6e1627",["f30bc0"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.manageTreatmentFlagsWithUpfrontPricingFlag=function(t){let n=t;const u=!!o.default.current().enable_upfront_pricing;u||(n=t.filter((t=>t!==H)));u&&!t.includes(H)&&(n=[...t,H]);return n.filter(h.default)},e.maybeRemoveUpfrontPricingParamsFromUrl=function(){requestIdleCallback((()=>{const t=o.default.current().enable_upfront_pricing;void 0!==t&&(0,p.airdogCount)('search.upfront_pricing.access_with_cookie',1,`value: ${t}`)}));(0,l.default)()[R]&&(0,c.getHistory)().replace(w())},e.setEnableUpfrontPricing=async function(t){return await(f.default.getBootstrap('api_web_client_migration.fejax.enabled')&&!f.default.getBootstrap('api_web_client_migration.fejax.pricing_guest.kill_switch')?(0,b().logMigration)(_().default.get("/_/core-guest-loop/upfront-pricing",{searchParams:{enable_upfront_pricing:t?'true':'false'}}),{method:'GET',client:'niobe',migrationId:'pricing_guest',group:'fejax'}):(0,b().logMigration)(u.default.ajax("/_/core-guest-loop/upfront-pricing?enable_upfront_pricing="+(t?'true':'false'),{dataType:'json',processResponse:!1}),{method:'GET',client:'fejax',migrationId:'pricing_guest',group:'fejax'})),o.default.setCurrent({...o.default.current(),enable_upfront_pricing:t}),Promise.resolve()},e.shouldShowUpfrontPricingBanner=function(){if(f.default.getBootstrap('pricing_upfront_pricing_2022_toggle_killswitch'))return!1;if(E())return!1;return!0};var t=babelHelpers.interopRequireDefault(r(d[0])),n=r(d[1]),o=babelHelpers.interopRequireDefault(r(d[2])),u=babelHelpers.interopRequireDefault(r(d[3])),l=babelHelpers.interopRequireDefault(r(d[4])),c=r(d[5]),f=babelHelpers.interopRequireDefault(r(d[6])),p=r(d[7]),s=r(d[8]);function _(){const t=babelHelpers.interopRequireDefault(r(d[9]));return _=function(){return t},t}function b(){const t=r(d[10]);return b=function(){return t},t}var h=babelHelpers.interopRequireDefault(r(d[11]));const R='enable_upfront_pricing',H='upfront_pricing_enabled',I=['AT','BE','BG','HR','CY','CZ','DK','EE','FI','FR','DE','GR','IE','IT','LV','LT','LU','MT','NL','PL','PT','RO','SK','SI','ES','SE','GB','IS','LI','NO','AU','KR','CH','HU','CA','IL','CN','NZ'];function w(){const t=(0,l.default)(),{pathname:o,hash:u}=window.location,c={...t};delete c[R];return`${o}?${(0,n.stringify)(c)}${u}`}function E(){return!!(I.includes(t.default.country())||I.includes(t.default.tld_country())||(0,s.isInChinaFlow)())}}),"74d137",["862e50","e950a3","06a99e","c3984f","a7c4ef","7934b6","c235f8","3e4681","b7eb08","69a7c4","7c530a","f30bc0"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.logMigration=function(u,c){return Promise.resolve(u).then((()=>n({...c,result:'success'}))).catch((u=>{n({...c,result:'error',responseStatus:null==u?void 0:u.status,noError:!u}),s.default.getBootstrap('niobe.rest.error_logging.kill_switch')||!u||u.status&&200!==u.status||((0,t.airdogCount)('rest_migration.debug',1,{...c,responseStatus:u.status,responseStatusText:u.statusText,message:u.message||'',name:u.name||''}),(0,o().reportNiobeError)(u,{fingerprint:['niobe'],tags:{...c}}))})).catch((()=>{})),u};var t=r(d[0]),s=babelHelpers.interopRequireDefault(r(d[1]));function o(){const t=r(d[2]);return o=function(){return t},t}function n(s){(0,t.airdogCount)('rest_migration.request',1,s)}}),"7c530a",["3e4681","c235f8","8e002d"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=r(d[0]),l=r(d[1]),o=babelHelpers.interopRequireDefault(r(d[2])),n=r(d[3]),u=babelHelpers.interopRequireDefault(r(d[4])),s=r(d[5]);var c=function({location:c,cookie:p,loadQuery:f,exploreTreatments:v,getRenderingState:_,customPrepareNiobeData:R,previousPrepareProps:b,getErf:y}){var T,F,S,h,k,q,x;const{isAirlite:O=!1,isBotRequest:C,formFactor:D=l.DEFAULT_FORM_FACTOR}=R||{},A=(0,t.createTaskController)(),E=null==b||null===(T=b.queryRef)||void 0===T||null===(F=T.result)||void 0===F||null===(S=F.data)||void 0===S||null===(h=S.presentation)||void 0===h||null===(k=h.staysSearch)||void 0===k||null===(q=k.results)||void 0===q||null===(x=q.categoryBar)||void 0===x?void 0:x.categoryBarCacheId,P=(0,s.getRequestVariables)({categoryBarCacheId:E,cookie:p,exploreTreatments:v,location:c,formFactor:D,isAirlite:O}),B=(0,n.getRedirectUrl)(c);let I=!1;return C||(I=!0),D===l.FORM_FACTOR.WIDE?(0,o.default)({experimentName:"feed_map_decouple_homepage_desktop",exploreTreatments:v,renderingState:_(),getErfServer:y}):(0,o.default)({experimentName:"feed_map_decouple_homepage_moweb",exploreTreatments:v,renderingState:_(),getErfServer:y}),{queryRef:f({context:{fetchOptions:{signal:null==A?void 0:A.signal},taskController:A},variables:P,query:u.default,deferrable:I,usePOSTForQuery:!0,skip:null!=B}),showDeferredSkeleton:I,redirectUrl:B}};e.default=c}),"7d5900",["a2c93f","b679e8","d271b5","0ef88a","3e1d2e","360d23"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.feedMapDecouplingHomepageWebPreSSR=function(u){return!(null==u||!u.includes(n))},e.feedMapDecouplingM11WebPreSSR=function(n,_){return!t(n)&&!(null==_||!_.includes(u))},e.isP2_5=t;const n='feed_map_decouple_homepage_treatment',u='feed_map_decouple_m11_treatment';function t(n){return null!=n.omni_page_id&&null!=n.dynamic_product_ids}}),"88c0d4",[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(u,n=(0,t.default)()){return n.find((({experiment:t})=>t===u))};var t=babelHelpers.interopRequireDefault(r(d[0]))}),"9439c5",["23c701"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.STAYS_SEARCH_FILTER_KEYS=e.KNOWN_SEARCH_QUERY_PARAMS=void 0;const _=['cursor','autosuggestions_options','max_categories','metadata_only','satori_version','search_type','source','treatment_flags','raw_params'];e.STAYS_SEARCH_FILTER_KEYS=_;const t=[..._,'inst','niobe_test_destinations','zoom'];e.KNOWN_SEARCH_QUERY_PARAMS=t}),"977a9f",[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function({experimentName:l,exploreTreatments:u,renderingState:o,getErfServer:s}){const{treatmentName:f,log:p}=(0,n.default)(l,u)||{};f&&'manual'===p&&('server-render'===o?s(l):'client-render'===o&&t.default.logCustomHashing(l,f))};var t=babelHelpers.interopRequireDefault(r(d[0])),n=babelHelpers.interopRequireDefault(r(d[1]))}),"d271b5",["fc0842","9439c5"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(_=[]){return _.filter((({experiment:_})=>"new_filter_bar_search_feed_header_v2_desktop"!==_&&"new_filter_bar_v2_moweb"!==_))}}),"d9a26e",[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.getRawParamSingleValue=function(l,t){var n,u;return null!==(n=null===(u=q(l,t))||void 0===u?void 0:u[0])&&void 0!==n?n:null},e.merge=function(l,n,u){const{rawParams:o,...s}=l,{rawParams:c,...f}=n,p=new Set(Object.keys(u||{}).map(t.default)),R={};null==o||o.forEach((({filterName:l,filterValues:t})=>{l&&!p.has(l)&&(R[l]=t)})),null==c||c.forEach((({filterName:l,filterValues:t})=>{l&&(R[l]=t)}));const v=S(Object.entries(R).map((([l,t])=>({filterName:l,filterValues:t}))));return{...s,...f,rawParams:v}},e.selectFiltersFromURL=y,e.selectSearchFiltersForRequest=_;var l=babelHelpers.interopRequireDefault(r(d[0])),t=babelHelpers.interopRequireWildcard(r(d[1])),n=babelHelpers.interopRequireWildcard(r(d[2])),u=babelHelpers.interopRequireDefault(r(d[3])),o=r(d[4]),s=babelHelpers.interopRequireDefault(r(d[5])),c=r(d[6]),f=r(d[7]),p=r(d[8]);function R(u,o){return(0,t.snakeKeysToCamelKeys)((0,l.default)((0,n.coerceCorrectTypes)(u,{forRequest:!0}),o))}function v(t){return(0,l.default)((0,s.default)(t),p.KNOWN_SEARCH_QUERY_PARAMS)}function y({queryString:l}){const t={...v(l)};return{...(0,n.default)({...t})}}function q(l,t){if(null!=l){const n=l.find((l=>(null==l?void 0:l.filterName)===t));if(null!=(null==n?void 0:n.filterValues)&&n.filterValues.length>0)return n.filterValues}return null}function S(l){const t=[...l];return t.sort(((l,t)=>{var n,u;return(null!==(n=null==l?void 0:l.filterName)&&void 0!==n?n:'').localeCompare(null!==(u=null==t?void 0:t.filterName)&&void 0!==u?u:'')})),t}function _({location:n,exploreRequest:s,filterKeys:f,isAirlite:p=!1}){const v=(0,u.default)(s,...f.map(t.default)),q=y({queryString:null==n?void 0:n.search}),_=(0,l.default)((0,o.camelKeysToSnakeKeys)(s),f);return{...R({...q.cursor&&{cursor:q.cursor},...p&&{max_categories:8},..._,raw_params:S((0,c.convertToRawParams)(v))},f)}}var b=function({location:l,exploreRequest:t,requestedPageType:n,isAirlite:u=!1,skipHydrationListingIds:o}){const s={requestedPageType:n,..._({location:l,exploreRequest:t,filterKeys:p.STAYS_SEARCH_FILTER_KEYS,isAirlite:u})};return s.searchType===f.SearchType.USER_MAP_MOVE&&null!=o&&o.length?{...s,skipHydrationListingIds:o}:s};e.default=b}),"e16093",["45db44","fd0757","c6fd31","3d4f9e","2755ca","a7c4ef","294886","6660fd","977a9f"]);
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/frontend/homepage/routes/HomepageRoute/HomepageRoute.prepare.188bc3ea4b.js.map